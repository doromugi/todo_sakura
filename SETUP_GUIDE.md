# サクラエディタ TODO記号切り替えマクロ 詳細設定ガイド

## 設定手順（スクリーンショット付き）

### Step 1: マクロファイルの配置

1. **マクロフォルダの確認**
   ```
   デフォルトパス：
   C:\Users\[ユーザー名]\AppData\Roaming\sakura\macro\
   
   または
   
   サクラエディタインストールフォルダ\macro\
   ```

2. **ファイルの配置**
   - `toggle_todo_symbols.js` を上記フォルダにコピー

### Step 2: サクラエディタでのマクロ登録（詳細手順）

#### 2-1. 共通設定を開く
1. サクラエディタのメニューから **設定** → **共通設定** をクリック
2. **マクロ** タブをクリック

#### 2-2. マクロスロットの選択
1. 左側の「マクロ一覧」から未使用のスロットを選択
   - 例：「マクロ01」「マクロ02」など
2. 右側の設定項目が表示されることを確認

#### 2-3. マクロファイルの指定
1. **ファイル** 欄の右側にある **...** ボタンをクリック
2. ファイル選択ダイアログで `toggle_todo_symbols.js` を選択
3. **開く** をクリック

#### 2-4. マクロ名の設定
1. **名前** 欄に分かりやすい名前を入力
   - 推奨：「TODO記号切り替え」「TODO Toggle」など
2. 必要に応じて **Id** を変更（通常はそのまま）

#### 2-5. 設定の保存
1. **OK** ボタンをクリックして設定を保存

### Step 3: ショートカットキーの設定（詳細手順）

#### 3-1. キー割り当て設定を開く
1. サクラエディタのメニューから **設定** → **共通設定** をクリック
2. **キー割り当て** タブをクリック

#### 3-2. マクロ機能の選択
1. **種別** ドロップダウンから **外部マクロ** を選択
2. **機能** リストに登録したマクロが表示されることを確認
3. 設定したいマクロ（例：「TODO記号切り替え」）をクリックして選択

#### 3-3. キーの割り当て
1. **割り当てるキー** 欄をクリック
2. 設定したいキーコンビネーションを押下
   - 例：`Ctrl` キーを押しながら `T` キーを押下
3. 欄に「Ctrl+T」などと表示されることを確認

#### 3-4. 割り当ての実行
1. **割り当て** ボタンをクリック
2. **現在のキー割り当て** リストに追加されることを確認

#### 3-5. 設定の保存
1. **OK** ボタンをクリックして設定を保存

## 動作テスト手順

### 基本動作テスト

1. **新規ファイルでのテスト**
   ```
   1. サクラエディタで新規ファイルを作成
   2. 以下の行を入力：
      テスト行
   3. カーソルを行の先頭に移動
   4. 設定したショートカットキーを押下
   5. 結果確認：□テスト行
   ```

2. **記号切り替えテスト**
   ```
   1. 上記の状態から再度ショートカットキーを押下
   2. 結果確認：◆テスト行
   3. さらに押下
   4. 結果確認：■テスト行
   5. さらに押下
   6. 結果確認：□テスト行（循環確認）
   ```

### インデント保持テスト

1. **タブインデントテスト**
   ```
   1. 以下の行を入力（先頭にタブ文字）：
   	テスト行
   2. ショートカットキー押下
   3. 結果確認：	□テスト行
   ```

2. **スペースインデントテスト**
   ```
   1. 以下の行を入力（先頭に半角スペース4個）：
       テスト行
   2. ショートカットキー押下
   3. 結果確認：    □テスト行
   ```

3. **全角スペースインデントテスト**
   ```
   1. 以下の行を入力（先頭に全角スペース2個）：
   　　テスト行
   2. ショートカットキー押下
   3. 結果確認：　　□テスト行
   ```

### 混合インデントテスト

```
1. 以下の行を入力（タブ+半角スペース+全角スペースの混合）：
	  　テスト行
2. ショートカットキー押下
3. 結果確認：	  　□テスト行
4. インデント部分が完全に保持されることを確認
```

## よくある問題と解決方法

### Q1: マクロが一覧に表示されない

**A1:** 以下を確認してください
- ファイルパスが正しいか
- ファイル名が正しいか（拡張子含む）
- ファイルの文字エンコーディングがUTF-8かShift_JISか
- サクラエディタを再起動したか

### Q2: ショートカットキーを押しても反応しない

**A2:** 以下を確認してください
- キー割り当てが正しく設定されているか
- 他の機能と競合していないか
- カーソルが正しい位置にあるか
- サクラエディタがアクティブウィンドウか

### Q3: 記号が正しく表示されない

**A3:** 以下を確認してください
- フォントが記号に対応しているか
- 文字エンコーディングが適切か
- サクラエディタの表示設定を確認

### Q4: インデントが保持されない

**A4:** 以下を確認してください
- マクロファイルが最新版か
- タブと半角スペースが混在していないか
- 全角スペースが含まれていないか（意図的でない場合）

## 高度な設定

### カスタムショートカットキーの推奨設定

| 用途 | 推奨キー | 理由 |
|------|----------|------|
| 頻繁使用 | `Ctrl+T` | Todoの頭文字、覚えやすい |
| サブ用途 | `Ctrl+Shift+T` | Ctrl+Tのバリエーション |
| ファンクションキー | `F11` | 他機能と競合しにくい |
| テンキー | `Ctrl+Num5` | 右手操作が楽 |

### 複数マクロの管理

複数のTODO関連マクロを使用する場合：

1. **マクロ命名規則**
   - `TODO記号切り替え`
   - `TODO完了チェック`
   - `TODO日付挿入`

2. **キー割り当て規則**
   - `Ctrl+T` - 記号切り替え
   - `Ctrl+Shift+T` - 完了チェック
   - `Ctrl+Alt+T` - 日付挿入

## サポート情報

問題が解決しない場合は、以下の情報を含めてサポートに連絡してください：

- サクラエディタのバージョン
- Windowsのバージョン
- マクロファイルのパス
- エラーメッセージ（あれば）
- 実行した手順